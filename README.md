## Summary of Language Projects 2023

October 2023

These are private languages of mine. This is where docs and summaries about them come together.

### Languages
```
Language  Description (Notes)

M         Lower level systems language
Q         Lower level dynamic scripting language
ASM       x64 assembly in my take on Intel syntax
'C'       C subset used by mcc compiler
```
The following are intermediate languages (not exposed and not independent):
```
PCL(M)    Intermediate Language used by M compiler
PCL(Q)    Bytecode language used b the Q interpreter
```

### Tools
```
Tool        Folder  Impl In  Description

mm.exe      mx      M        M Compiler
runmx.exe   mx      M        Stub program to run .mx executables (4)

aa.exe      ax      M        ASM assembler

qq.exe      qx      M        Q bytecode compiler and interpreter (Q5.2)

mcc.exe     cx      M        C subset compiler (10)
  
```

### File Extensions
```
Extension  Represents  Description

.m         Module      M source file
.ma        Program     M amalgamated source file (5)
.ml        Library     Private shared library format (4)
.mx        Program     Private executable code format
.exp       Library     Temporary output file of -ml/-mx options: exports info

.asm       Program*    AA assembly source file (*Module when generated by MCC compiler)
(.nasm     Program*    Proposed assembly source file using NASM syntax)
.q         Module      Q source file
.qa        Program     Q amalgamated source file (6)

```

### Inputs and Outputs
```
Tool      Input   N   Output   Option    Description

mm.exe    .m .ma  1   .exe     -exe      (Default) Compile to executable
                      .asm     -asm      Write single-file assembly file
                      .ma      -ma       Write amalgamated source file
                               -mas      Same but includes standard library files
                      .ml      -ml       Write shared library file in private format
                      .mx      -mx       Write executable in private format
                      Run      -run      Compile and run in-memory (ms.exe is better for this)

qq.exe    .q .qa  1   Run                (Default) Compile and run bytecode in-memory
                      .qa      -qa       Write amalgamated source file ...
                               -qas      ... with standard library

aa.exe    .asm    N  .exe      -exe      (Default) Create executable
                     .obj      -obj      Write single object file (6)
                     .dll      -dll      Write DLL file (7)

runmx.exe .mx     1  Run                 Run .mx application

mcc.exe   .c      N  .exe      -exe      (Default) Compile .c files to .exe via .asm/aa.exe
                     .obj      -c        Compile individual .c files to .obj via .asm/aa.exe
                     .asm      -s        Compile individual .c files to .asm
                     .i        -e        Preprocess individual .c files to .i
                     .m        -mheaders Translate headers to M syntax in .m file
```

N indicates the number of input files accepted. Only `mcc.exe`, and `aa.exe` because it was used to combine .asm outputs of MCC, accept multiple source files. All my own languages generally work from a single submitted module.

### Notes

**(4)** (See **7**) Because of problems with DLLs, I created my own simpler shared library format using `.ml` files. These are accepted by Q programs, but in M, can only be transparently used by `.mx` files, or accessed via a special API from regular `.exe`.

The format can also be used to write complete apps, with `.mx` extension, but being unknown to Windows, those must be started by a stub program `run.exe`

**(5)** The `-ma` option of M compiler combines all source files and support files (from `include` and `strinclude`) into a single file. This is easy to backup, transmit, copy etc. And it can be directly be compiled in that form: `mm prog.ma`.

**(6)** The `-qa` option does a similar job for Q programs, and there is is necessary for packaging applications, as there is no longer a binary file format for bytecode

**(7)** `mm.exe` used to produce DLL files, which could be relocated with the low 2GB of virtual address space. But sometimes it can be loaded higher, and I think that caused the problems I sometimes had. Loading above 2GB requires RIP-relative addressing, and other code-generation to choices to get around the problem of absolute addresses above 2GB not fitting into a 32-bit field. My code generators don't yet do that.

**(8)** OBJ files can still be produced by `aa.exe`, to allow combining with other software. But they need a third party linker, and these now like to create images that can also be loaded above 2GB. So at present DLL and OBJ outputs are shelved until I can sort that out.

**(11)** MC was an M to C transpiler. It only supported a subset of M (so certain M features couldn't be used), and had been archived, but is active once again because it is too useful.
